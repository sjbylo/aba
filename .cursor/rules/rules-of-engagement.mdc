---
description: Critical rules for AI assistant working on the ABA project
alwaysApply: true
---

# ABA Project Rules (Always Active)

## NEVER commit or push without explicit user permission

- Do NOT commit after making changes
- Do NOT commit when user says "ok" or "continue" (unless specifically about commits)
- Do NOT push to origin without being asked
- ALWAYS ask "Should I commit and push?" when work is complete
- WAIT for user to explicitly say "yes", "commit", "push", or "commit and push"

## NEVER add AI attribution to commits

- No "Co-authored-by: Cursor" or similar tags in commit messages

## Git workflow

- Work on the `dev` branch
- Default: commit AND push together (unless told otherwise)
- Run `build/pre-commit-checks.sh` before committing code changes
- Run `build/pre-commit-checks.sh --skip-version` for docs-only commits

## Backup uncommitted changes before editing

- Before editing a file, check if it has uncommitted changes (`git diff --name-only`)
- If it does, back it up to `.backup/` preserving the path: `mkdir -p .backup/DIR && cp FILE .backup/DIR/`
- Example: `tui/foo.sh` backs up to `.backup/tui/foo.sh`
- Clean up `.backup/` after a successful commit
- `.backup/` is gitignored -- backups never get committed
- This guards against unexplained file reverts/deletions

## "Show me" means SHOW, not APPLY

- When user says "show me" a change, display it -- do not edit the file
- Only apply changes when user explicitly approves

## File modification permissions

- CAN modify freely: `test/func/*`, `ai/*`
- CAN modify with permission: `scripts/include_all.sh`, `scripts/aba.sh`
- CANNOT modify without explicit request: all other `scripts/*.sh`, Makefiles

## Coding style

- Use TABS for indentation, never spaces
- Empty lines must have NO characters (no trailing whitespace)
- Add comments for non-obvious bash features

## Key architecture

- Use `run_once()` for all task management -- never access `~/.aba/runner/` directly
- Use relative paths -- avoid `$ABA_ROOT` (only `aba.sh` should use it)
- Use `ensure_*()` functions for CLI tool installation
- Symlinks handle cross-directory access (scripts use same paths everywhere)

## For full details see `ai/RULES_OF_ENGAGEMENT.md`
